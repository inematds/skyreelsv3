<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>INEMA SkyReels V3 3.10.3 ‚Äî Ajuda da Fila</title>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: system-ui, sans-serif;
    background: #0f0f13;
    color: #d0d0e0;
    min-height: 100vh;
    line-height: 1.6;
  }

  /* ---- HEADER ---- */
  .page-header {
    background: #1a1a24;
    border-bottom: 1px solid #2a2a3a;
    padding: 14px 32px;
    display: flex;
    align-items: center;
    gap: 16px;
    position: sticky;
    top: 0;
    z-index: 10;
  }
  .page-header a {
    font-size: 0.8rem;
    color: #7c3aed;
    text-decoration: none;
    padding: 5px 12px;
    border: 1px solid #3a2a6a;
    border-radius: 6px;
    transition: all .2s;
  }
  .page-header a:hover { background: #2a1a4a; border-color: #7c3aed; }
  .page-header h1 { font-size: 1.1rem; color: #a78bfa; flex: 1; }
  .page-header span { font-size: 0.78rem; color: #555; }

  /* ---- LAYOUT ---- */
  .content {
    max-width: 960px;
    margin: 0 auto;
    padding: 36px 32px 80px;
  }

  /* ---- NAV ---- */
  .toc {
    background: #14141e;
    border: 1px solid #2a2a3a;
    border-radius: 10px;
    padding: 16px 20px;
    margin-bottom: 40px;
  }
  .toc-title { font-size: 0.7rem; text-transform: uppercase; letter-spacing: .08em; color: #555; margin-bottom: 10px; }
  .toc ul { list-style: none; display: flex; flex-wrap: wrap; gap: 8px 20px; }
  .toc a { font-size: 0.82rem; color: #7c7caa; text-decoration: none; }
  .toc a:hover { color: #a78bfa; }

  /* ---- SECTIONS ---- */
  h2 {
    font-size: 1.1rem;
    color: #a78bfa;
    border-bottom: 1px solid #2a2a3a;
    padding-bottom: 8px;
    margin: 40px 0 18px;
  }
  h3 { font-size: 0.9rem; color: #c4b5fd; margin: 24px 0 10px; }
  p { font-size: 0.88rem; color: #999; margin-bottom: 12px; }
  strong { color: #d0d0e0; }

  /* ---- TABLES ---- */
  table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.82rem;
    margin-bottom: 20px;
  }
  th {
    background: #1a1a28;
    color: #888;
    font-weight: 600;
    padding: 8px 12px;
    text-align: left;
    border-bottom: 1px solid #2a2a3a;
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: .04em;
  }
  td { padding: 8px 12px; border-bottom: 1px solid #1a1a28; color: #bbb; vertical-align: top; }
  tr:last-child td { border-bottom: none; }
  tr:hover td { background: #16161f; }
  td code { background: #1e1e2e; border-radius: 4px; padding: 1px 6px; font-size: 0.8rem; color: #a78bfa; }
  td.req { color: #f59e0b; font-size: 0.75rem; font-weight: 600; }
  td.opt { color: #555; font-size: 0.75rem; }

  /* ---- CODE BLOCKS ---- */
  .code-wrap {
    background: #0a0a10;
    border: 1px solid #1e1e2e;
    border-radius: 10px;
    overflow: hidden;
    margin-bottom: 20px;
  }
  .code-header {
    display: flex;
    align-items: center;
    padding: 8px 14px;
    background: #14141e;
    border-bottom: 1px solid #1e1e2e;
    gap: 10px;
  }
  .code-header .lang {
    font-size: 0.7rem;
    color: #555;
    text-transform: uppercase;
    letter-spacing: .06em;
    flex: 1;
  }
  .code-header .fname { font-size: 0.72rem; color: #666; font-family: monospace; }
  pre {
    margin: 0;
    padding: 16px;
    overflow-x: auto;
    font-size: 0.8rem;
    line-height: 1.65;
    font-family: 'Courier New', 'Consolas', monospace;
    color: #c0c0d8;
  }

  /* JSON syntax colours */
  .j-key   { color: #7dd3fc; }
  .j-str   { color: #86efac; }
  .j-num   { color: #fcd34d; }
  .j-bool  { color: #f9a8d4; }
  .j-null  { color: #94a3b8; }
  .j-punct { color: #555; }
  .j-comment { color: #4a5568; font-style: italic; }

  /* ---- EXAMPLE CARDS ---- */
  .example-card {
    background: #14141e;
    border: 1px solid #2a2a3a;
    border-radius: 12px;
    overflow: hidden;
    margin-bottom: 32px;
  }
  .example-card-header {
    padding: 14px 18px;
    background: #1a1a28;
    border-bottom: 1px solid #2a2a3a;
    display: flex;
    align-items: flex-start;
    gap: 14px;
  }
  .example-icon { font-size: 1.6rem; flex-shrink: 0; line-height: 1; margin-top: 2px; }
  .example-info { flex: 1; }
  .example-title { font-size: 0.95rem; color: #e0e0f0; font-weight: 600; margin-bottom: 4px; }
  .example-desc { font-size: 0.8rem; color: #666; line-height: 1.5; }
  .example-actions {
    display: flex;
    gap: 8px;
    align-items: center;
    flex-shrink: 0;
  }
  .btn-dl {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 8px 14px;
    background: #7c3aed;
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 0.8rem;
    font-weight: 600;
    cursor: pointer;
    text-decoration: none;
    transition: background .2s;
  }
  .btn-dl:hover { background: #6d28d9; }
  .btn-copy {
    padding: 8px 12px;
    background: #1e1e2e;
    color: #888;
    border: 1px solid #333;
    border-radius: 8px;
    font-size: 0.8rem;
    cursor: pointer;
    transition: all .2s;
    white-space: nowrap;
  }
  .btn-copy:hover { border-color: #7c3aed; color: #a78bfa; }
  .btn-copy.copied { border-color: #4ade80; color: #4ade80; }

  .example-scenes {
    padding: 14px 18px 6px;
    border-bottom: 1px solid #1a1a28;
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
  }
  .scene-badge {
    font-size: 0.7rem;
    padding: 3px 8px;
    border-radius: 99px;
    border: 1px solid;
    white-space: nowrap;
  }
  .badge-r2v { color: #818cf8; border-color: #2e2a5a; background: #0d0d1e; }
  .badge-sse { color: #34d399; border-color: #1a3a2a; background: #0a1a12; }
  .badge-sw  { color: #fbbf24; border-color: #3a2e10; background: #1a1208; }
  .badge-av  { color: #f472b6; border-color: #3a1a2a; background: #1a0d14; }

  /* ---- NOTE BOX ---- */
  .note {
    background: #1a1a28;
    border-left: 3px solid #7c3aed;
    border-radius: 0 8px 8px 0;
    padding: 10px 14px;
    font-size: 0.82rem;
    color: #888;
    margin: 16px 0;
    line-height: 1.55;
  }
  .note.warn { border-color: #f59e0b; }
  .note code { background: #0a0a14; border-radius: 4px; padding: 1px 6px; color: #fcd34d; font-size: 0.8rem; }

  /* ---- INLINE CODE ---- */
  code { background: #1e1e2e; border-radius: 4px; padding: 1px 6px; font-size: 0.82rem; color: #a78bfa; }

  /* ---- TAGS ---- */
  .tag-list { display: flex; flex-wrap: wrap; gap: 6px; margin: 10px 0 16px; }
  .tag {
    font-size: 0.72rem;
    padding: 3px 10px;
    border-radius: 99px;
    background: #1a1a28;
    border: 1px solid #2a2a3a;
    color: #888;
    font-family: monospace;
  }
  .tag.purple { color: #a78bfa; border-color: #3a2a6a; background: #12102a; }
</style>
</head>
<body>

<div class="page-header">
  <a href="/">‚Üê Voltar</a>
  <h1>Ajuda ‚Äî Fila de Gera√ß√£o</h1>
  <span>INEMA SkyReels V3 3.10.3</span>
</div>

<div class="content">

  <!-- TOC -->
  <div class="toc">
    <div class="toc-title">Nesta p√°gina</div>
    <ul>
      <li><a href="#como-usar">Como usar a fila</a></li>
      <li><a href="#formato-json">Formato JSON</a></li>
      <li><a href="#formato-md">Formato Markdown</a></li>
      <li><a href="#campos">Campos por tarefa</a></li>
      <li><a href="#limites">Limites e regras</a></li>
      <li><a href="#caminhos">Caminhos de arquivo</a></li>
      <li><a href="#referencias">Refer√™ncias entre cenas</a></li>
      <li><a href="#exemplos">Exemplos prontos</a></li>
      <li><a href="/doc/CHANGELOG.md" target="_blank">üìã Changelog completo</a></li>
    </ul>
  </div>

  <!-- COMO USAR -->
  <h2 id="como-usar">Como usar a fila</h2>
  <p>A aba <strong>Fila</strong> permite enfileirar m√∫ltiplos jobs de gera√ß√£o que rodam automaticamente um ap√≥s o outro, sem que voc√™ precise ficar monitorando.</p>

  <table>
    <tr><th>A√ß√£o</th><th>Como fazer</th></tr>
    <tr><td><strong>Adicionar job manual</strong></td><td>Preencha o formul√°rio no painel esquerdo e clique em <strong>+ Fila</strong></td></tr>
    <tr><td><strong>Importar arquivo</strong></td><td>Aba Fila ‚Üí bot√£o <strong>‚Üë Importar</strong> ‚Üí selecione um <code>.json</code> ou <code>.md</code></td></tr>
    <tr><td><strong>Remover job</strong></td><td>Clique no <strong>‚úï</strong> ao lado do job (s√≥ funciona em jobs pendentes)</td></tr>
    <tr><td><strong>Limpar fila</strong></td><td>Bot√£o <strong>Limpar</strong> remove todos os jobs pendentes</td></tr>
    <tr><td><strong>Gerar imediatamente</strong></td><td>Bot√£o <strong>Gerar V√≠deo</strong> tamb√©m usa a fila ‚Äî come√ßa agora se n√£o h√° nada rodando</td></tr>
  </table>

  <div class="note">
    A fila roda os jobs na ordem em que foram adicionados. O pr√≥ximo job come√ßa automaticamente quando o anterior termina (ou falha).
  </div>

  <!-- FORMATO JSON -->
  <h2 id="formato-json">Formato JSON</h2>
  <p>Um array de objetos. Cada objeto √© um job. Salve com extens√£o <code>.json</code>.</p>

  <div class="code-wrap">
    <div class="code-header">
      <span class="lang">JSON</span>
      <span class="fname">minha_fila.json</span>
    </div>
<pre><span class="j-punct">[</span>
  <span class="j-punct">{</span>
    <span class="j-key">"label"</span><span class="j-punct">:</span>       <span class="j-str">"Cena 1 ‚Äî Abertura"</span><span class="j-punct">,</span>
    <span class="j-key">"task_type"</span><span class="j-punct">:</span>   <span class="j-str">"reference_to_video"</span><span class="j-punct">,</span>
    <span class="j-key">"prompt"</span><span class="j-punct">:</span>      <span class="j-str">"A woman walks through a sunlit forest, cinematic."</span><span class="j-punct">,</span>
    <span class="j-key">"resolution"</span><span class="j-punct">:</span>  <span class="j-str">"540P"</span><span class="j-punct">,</span>
    <span class="j-key">"duration"</span><span class="j-punct">:</span>    <span class="j-num">5</span><span class="j-punct">,</span>
    <span class="j-key">"seed"</span><span class="j-punct">:</span>        <span class="j-num">42</span><span class="j-punct">,</span>
    <span class="j-key">"offload"</span><span class="j-punct">:</span>     <span class="j-bool">true</span><span class="j-punct">,</span>
    <span class="j-key">"low_vram"</span><span class="j-punct">:</span>    <span class="j-bool">false</span><span class="j-punct">,</span>
    <span class="j-key">"ref_imgs"</span><span class="j-punct">:</span>    <span class="j-punct">[</span><span class="j-str">"uploads/personagem.jpg"</span><span class="j-punct">,</span> <span class="j-str">"uploads/floresta.jpg"</span><span class="j-punct">]</span>
  <span class="j-punct">},</span>
  <span class="j-punct">{</span>
    <span class="j-key">"label"</span><span class="j-punct">:</span>       <span class="j-str">"Cena 2 ‚Äî Extens√£o"</span><span class="j-punct">,</span>
    <span class="j-key">"task_type"</span><span class="j-punct">:</span>   <span class="j-str">"single_shot_extension"</span><span class="j-punct">,</span>
    <span class="j-key">"prompt"</span><span class="j-punct">:</span>      <span class="j-str">"She stops to look at a deer in the distance."</span><span class="j-punct">,</span>
    <span class="j-key">"resolution"</span><span class="j-punct">:</span>  <span class="j-str">"540P"</span><span class="j-punct">,</span>
    <span class="j-key">"duration"</span><span class="j-punct">:</span>    <span class="j-num">10</span><span class="j-punct">,</span>
    <span class="j-key">"seed"</span><span class="j-punct">:</span>        <span class="j-num">43</span><span class="j-punct">,</span>
    <span class="j-key">"offload"</span><span class="j-punct">:</span>     <span class="j-bool">true</span><span class="j-punct">,</span>
    <span class="j-key">"input_video"</span><span class="j-punct">:</span> <span class="j-str">"{{ "{{prev}}" }}"</span>
  <span class="j-punct">},</span>
  <span class="j-punct">{</span>
    <span class="j-key">"label"</span><span class="j-punct">:</span>       <span class="j-str">"Cena 3 ‚Äî Avatar narrador"</span><span class="j-punct">,</span>
    <span class="j-key">"task_type"</span><span class="j-punct">:</span>   <span class="j-str">"talking_avatar"</span><span class="j-punct">,</span>
    <span class="j-key">"prompt"</span><span class="j-punct">:</span>      <span class="j-str">"A narrator speaking calmly."</span><span class="j-punct">,</span>
    <span class="j-key">"resolution"</span><span class="j-punct">:</span>  <span class="j-str">"480P"</span><span class="j-punct">,</span>
    <span class="j-key">"seed"</span><span class="j-punct">:</span>        <span class="j-num">99</span><span class="j-punct">,</span>
    <span class="j-key">"low_vram"</span><span class="j-punct">:</span>    <span class="j-bool">true</span><span class="j-punct">,</span>
    <span class="j-key">"input_image"</span><span class="j-punct">:</span> <span class="j-str">"uploads/retrato.jpg"</span><span class="j-punct">,</span>
    <span class="j-key">"input_audio"</span><span class="j-punct">:</span> <span class="j-str">"uploads/narracao.mp3"</span>
  <span class="j-punct">}</span>
<span class="j-punct">]</span></pre>
  </div>

  <!-- FORMATO MD -->
  <h2 id="formato-md">Formato Markdown</h2>
  <p>Cada job √© uma se√ß√£o <code>##</code>. Os campos s√£o linhas <code>- chave: valor</code>. Salve com extens√£o <code>.md</code> ou <code>.txt</code>.</p>

  <div class="code-wrap">
    <div class="code-header">
      <span class="lang">Markdown</span>
      <span class="fname">minha_fila.md</span>
    </div>
<pre><span style="color:#6b7280"># Meu Roteiro</span>

<span style="color:#a78bfa">## Cena 1 ‚Äî Abertura</span>
<span style="color:#c4b5fd">- task_type:</span> <span style="color:#86efac">reference_to_video</span>
<span style="color:#c4b5fd">- prompt:</span> <span style="color:#86efac">A woman walks through a sunlit forest, cinematic.</span>
<span style="color:#c4b5fd">- resolution:</span> <span style="color:#fcd34d">540P</span>
<span style="color:#c4b5fd">- duration:</span> <span style="color:#fcd34d">5</span>
<span style="color:#c4b5fd">- seed:</span> <span style="color:#fcd34d">42</span>
<span style="color:#c4b5fd">- offload:</span> <span style="color:#f9a8d4">true</span>
<span style="color:#c4b5fd">- ref_imgs:</span> <span style="color:#86efac">uploads/personagem.jpg, uploads/floresta.jpg</span>

<span style="color:#a78bfa">## Cena 2 ‚Äî Avatar</span>
<span style="color:#c4b5fd">- task_type:</span> <span style="color:#86efac">talking_avatar</span>
<span style="color:#c4b5fd">- prompt:</span> <span style="color:#86efac">Narrator speaking.</span>
<span style="color:#c4b5fd">- resolution:</span> <span style="color:#fcd34d">480P</span>
<span style="color:#c4b5fd">- seed:</span> <span style="color:#fcd34d">99</span>
<span style="color:#c4b5fd">- low_vram:</span> <span style="color:#f9a8d4">true</span>
<span style="color:#c4b5fd">- input_image:</span> <span style="color:#86efac">uploads/retrato.jpg</span>
<span style="color:#c4b5fd">- input_audio:</span> <span style="color:#86efac">uploads/narracao.mp3</span></pre>
  </div>

  <!-- CAMPOS -->
  <h2 id="campos">Campos por tarefa</h2>

  <table>
    <tr>
      <th>Campo</th>
      <th>Tipo</th>
      <th>reference_to_video</th>
      <th>single/shot_extension</th>
      <th>talking_avatar</th>
      <th>Descri√ß√£o</th>
    </tr>
    <tr>
      <td><code>task_type</code></td><td>string</td>
      <td class="req">‚úî obrigat√≥rio</td><td class="req">‚úî obrigat√≥rio</td><td class="req">‚úî obrigat√≥rio</td>
      <td>Nome da tarefa (ver valores abaixo)</td>
    </tr>
    <tr>
      <td><code>prompt</code></td><td>string</td>
      <td class="req">‚úî obrigat√≥rio</td><td class="req">‚úî obrigat√≥rio</td><td class="opt">opcional</td>
      <td>Descri√ß√£o do v√≠deo. No talking_avatar tem baixa influ√™ncia</td>
    </tr>
    <tr>
      <td><code>resolution</code></td><td>string</td>
      <td class="opt">opcional</td><td class="opt">opcional</td><td class="opt">opcional</td>
      <td><code>480P</code> / <code>540P</code> / <code>720P</code>. talking_avatar s√≥ aceita 480P e 720P</td>
    </tr>
    <tr>
      <td><code>duration</code></td><td>int</td>
      <td class="opt">opcional</td><td class="opt">opcional</td><td class="opt">ignorado</td>
      <td>Dura√ß√£o em segundos. talking_avatar usa a dura√ß√£o do √°udio</td>
    </tr>
    <tr>
      <td><code>seed</code></td><td>int</td>
      <td class="opt">opcional</td><td class="opt">opcional</td><td class="opt">opcional</td>
      <td>Semente. Mesmo seed + mesmos inputs = mesmo resultado</td>
    </tr>
    <tr>
      <td><code>offload</code></td><td>bool</td>
      <td class="opt">opcional</td><td class="opt">opcional</td><td class="opt">n/a</td>
      <td>CPU offload entre passes. Reduz VRAM mas aumenta tempo</td>
    </tr>
    <tr>
      <td><code>low_vram</code></td><td>bool</td>
      <td class="opt">opcional</td><td class="opt">opcional</td><td class="req">‚úî obrigat√≥rio</td>
      <td>FP8 + block offload. Obrigat√≥rio no talking_avatar (modelo 19B)</td>
    </tr>
    <tr>
      <td><code>ref_imgs</code></td><td>array</td>
      <td class="req">‚úî obrigat√≥rio</td><td>‚Äî</td><td>‚Äî</td>
      <td>1‚Äì4 caminhos ou URLs de imagens de refer√™ncia</td>
    </tr>
    <tr>
      <td><code>input_video</code></td><td>string</td>
      <td>‚Äî</td><td class="req">‚úî obrigat√≥rio</td><td>‚Äî</td>
      <td>Caminho, URL ou refer√™ncia (<code>{{ "{{prev}}" }}</code>, <code>{{ "{{job:N}}" }}</code>) do v√≠deo a estender. N√£o aceita imagens ‚Äî s√≥ v√≠deo.</td>
    </tr>
    <tr>
      <td><code>input_image</code></td><td>string</td>
      <td>‚Äî</td><td>‚Äî</td><td class="req">‚úî obrigat√≥rio</td>
      <td>Caminho ou URL do retrato (jpg, png, gif, bmp)</td>
    </tr>
    <tr>
      <td><code>input_audio</code></td><td>string</td>
      <td>‚Äî</td><td>‚Äî</td><td class="req">‚úî obrigat√≥rio</td>
      <td>Caminho ou URL do √°udio (mp3, wav, m4a, mp4, mov, mkv‚Ä¶)</td>
    </tr>
    <tr>
      <td><code>label</code></td><td>string</td>
      <td class="opt">opcional</td><td class="opt">opcional</td><td class="opt">opcional</td>
      <td>Nome amig√°vel exibido na lista da fila</td>
    </tr>
  </table>

  <div class="tag-list">
    <span class="tag purple">reference_to_video</span>
    <span class="tag purple">single_shot_extension</span>
    <span class="tag purple">shot_switching_extension</span>
    <span class="tag purple">talking_avatar</span>
  </div>

  <!-- LIMITES -->
  <h2 id="limites">Limites e regras</h2>

  <table>
    <tr><th>Tarefa</th><th>Dura√ß√£o</th><th>Resolu√ß√£o</th><th>Observa√ß√£o</th></tr>
    <tr>
      <td><code>reference_to_video</code></td>
      <td>1‚Äì30 s (recomendado 5 s)</td>
      <td>480P / 540P / 720P</td>
      <td>1‚Äì4 imagens de refer√™ncia</td>
    </tr>
    <tr>
      <td><code>single_shot_extension</code></td>
      <td>5‚Äì30 s</td>
      <td>480P / 540P / 720P</td>
      <td>V√≠deo de entrada obrigat√≥rio</td>
    </tr>
    <tr>
      <td><code>shot_switching_extension</code></td>
      <td>m√°x 5 s</td>
      <td>480P / 540P / 720P</td>
      <td>Prefixo no prompt obrigat√≥rio (ver tabela abaixo)</td>
    </tr>
    <tr>
      <td><code>talking_avatar</code></td>
      <td>= dura√ß√£o do √°udio (m√°x 200 s)</td>
      <td>480P / 720P</td>
      <td><code>low_vram: true</code> obrigat√≥rio</td>
    </tr>
  </table>

  <h3>Diferen√ßa entre as extens√µes</h3>

  <table>
    <tr>
      <th></th>
      <th><code>single_shot_extension</code></th>
      <th><code>shot_switching_extension</code></th>
    </tr>
    <tr>
      <td><strong>O que faz</strong></td>
      <td>Continua a cena de forma fluida ‚Äî a c√¢mera segue gravando o mesmo plano</td>
      <td>Simula um corte de c√¢mera ‚Äî muda de perspectiva como em filme</td>
    </tr>
    <tr>
      <td><strong>Contexto do input</strong></td>
      <td>Usa os √∫ltimos frames para continuar o movimento e a narrativa</td>
      <td>Usa os √∫ltimos frames para herdar apar√™ncia e ilumina√ß√£o no novo √¢ngulo</td>
    </tr>
    <tr>
      <td><strong>Dura√ß√£o</strong></td>
      <td>5‚Äì30 s</td>
      <td>m√°x 5 s</td>
    </tr>
    <tr>
      <td><strong>Prompt</strong></td>
      <td>Descreve o que acontece a seguir na cena</td>
      <td>Deve come√ßar com prefixo de corte: <code>[ZOOM_IN_CUT]</code> etc.</td>
    </tr>
    <tr>
      <td><strong>ref_imgs</strong></td>
      <td>N√£o aceita ‚Äî s√≥ <code>input_video</code></td>
      <td>N√£o aceita ‚Äî s√≥ <code>input_video</code></td>
    </tr>
  </table>

  <div class="note">
    <strong>Quando preferir <code>reference_to_video</code> no lugar de <code>shot_switching_extension</code>:</strong>
    se voc√™ quer mudar de plano mas tem imagens de refer√™ncia do personagem/cen√°rio,
    <code>reference_to_video</code> d√° mais controle visual, n√£o tem limite de 5 s e √© mais
    est√°vel em hardware com pouca VRAM. O <code>shot_switching_extension</code> vale a pena
    quando voc√™ quer que o novo plano herde automaticamente a apar√™ncia exata do clip
    anterior sem precisar preparar imagens adicionais.
  </div>

  <h3>Prefixos para shot_switching_extension</h3>
  <table>
    <tr><th>Prefixo</th><th>Efeito</th></tr>
    <tr><td><code>[ZOOM_IN_CUT]</code></td><td>C√¢mera aproxima ap√≥s o corte</td></tr>
    <tr><td><code>[ZOOM_OUT_CUT]</code></td><td>C√¢mera afasta ap√≥s o corte</td></tr>
    <tr><td><code>[STATIC_CUT]</code></td><td>Corte simples, c√¢mera est√°tica</td></tr>
    <tr><td><code>[PAN_LEFT_CUT]</code></td><td>Panor√¢mica para a esquerda</td></tr>
    <tr><td><code>[PAN_RIGHT_CUT]</code></td><td>Panor√¢mica para a direita</td></tr>
  </table>

  <!-- CAMINHOS -->
  <h2 id="caminhos">Caminhos de arquivo</h2>
  <p>Todos os caminhos s√£o relativos √† <strong>raiz do projeto</strong> (<code>SkyReels-V3/</code>).</p>

  <table>
    <tr><th>Local</th><th>Onde fica</th></tr>
    <tr><td>Uploads da interface web</td><td><code>uploads/nome_do_arquivo.jpg</code></td></tr>
    <tr><td>V√≠deos gerados</td><td><code>result/&lt;task_type&gt;/&lt;seed&gt;_&lt;data&gt;.mp4</code></td></tr>
    <tr><td>URL p√∫blica</td><td><code>https://exemplo.com/arquivo.mp3</code> (baixado automaticamente)</td></tr>
    <tr><td>Caminho absoluto</td><td><code>/home/usuario/arquivo.png</code></td></tr>
  </table>

  <!-- REFER√äNCIAS ENTRE CENAS -->
  <h2 id="referencias">Refer√™ncias entre cenas</h2>
  <p>
    Os campos <code>input_video</code>, <code>input_image</code> e <code>input_audio</code>
    aceitam tr√™s formas de valor:
  </p>

  <table>
    <tr>
      <th>Forma</th>
      <th>Exemplo</th>
      <th>Quando usar</th>
    </tr>
    <tr>
      <td><strong>Caminho fixo</strong></td>
      <td><code>uploads/meu_video.mp4</code></td>
      <td>arquivo j√° existe no servidor; n√£o muda entre gera√ß√µes</td>
    </tr>
    <tr>
      <td><code>{{ "{{prev}}" }}</code></td>
      <td><code>"input_video": "{{ "{{prev}}" }}"</code></td>
      <td>output da cena imediatamente anterior ‚Äî caso mais comum</td>
    </tr>
    <tr>
      <td><code>{{ "{{job:N}}" }}</code></td>
      <td><code>"input_video": "{{ "{{job:0}}" }}"</code></td>
      <td>output de qualquer cena pelo √≠ndice N (base 0)</td>
    </tr>
  </table>

  <div class="note">
    <strong>Resolu√ß√£o em tempo de execu√ß√£o:</strong> refer√™ncias din√¢micas (<code>{{ "{{prev}}" }}</code>,
    <code>{{ "{{job:N}}" }}</code>) s√£o substitu√≠das pelo caminho real do v√≠deo no momento
    em que o job come√ßa. Se a cena referenciada falhou ou ainda n√£o rodou, o job falha
    com aviso no log.
  </div>

  <h3 style="margin:20px 0 8px;font-size:.95rem;color:#c4b5fd">Quais campos aceitam refer√™ncias?</h3>
  <table>
    <tr><th>Campo</th><th>Tarefas</th><th>Aceita refer√™ncia?</th></tr>
    <tr>
      <td><code>input_video</code></td>
      <td><code>single_shot_extension</code>, <code>shot_switching_extension</code></td>
      <td>‚úî sim ‚Äî <code>{{ "{{prev}}" }}</code>, <code>{{ "{{job:N}}" }}</code> ou caminho fixo</td>
    </tr>
    <tr>
      <td><code>input_image</code></td>
      <td><code>talking_avatar</code></td>
      <td>‚úî sim ‚Äî caminho fixo ou refer√™ncia</td>
    </tr>
    <tr>
      <td><code>input_audio</code></td>
      <td><code>talking_avatar</code></td>
      <td>‚úî sim ‚Äî caminho fixo ou refer√™ncia</td>
    </tr>
    <tr>
      <td><code>ref_imgs</code></td>
      <td><code>reference_to_video</code></td>
      <td>‚ö† apenas caminhos fixos ‚Äî n√£o aceita <code>{{ "{{prev}}" }}</code></td>
    </tr>
  </table>

  <div class="note warn">
    <strong>Extension tasks n√£o aceitam imagens de refer√™ncia.</strong>
    <code>single_shot_extension</code> e <code>shot_switching_extension</code> s√≥ recebem
    <code>input_video</code> ‚Äî o campo <code>ref_imgs</code> √© ignorado nessas tarefas.
    Para guiar o estilo visual use o prompt de texto.
  </div>

  <div class="code-wrap">
    <div class="code-header"><span class="lang">JSON</span><span class="fname">exemplos de refer√™ncia</span></div>
<pre><span class="j-punct">[</span>
  <span class="j-punct">{</span>
    <span class="j-key">"label"</span><span class="j-punct">:</span>      <span class="j-str">"Cena 1 ‚Äî Abertura"</span><span class="j-punct">,</span>
    <span class="j-key">"task_type"</span><span class="j-punct">:</span>  <span class="j-str">"reference_to_video"</span><span class="j-punct">,</span>
    <span class="j-key">"resolution"</span><span class="j-punct">:</span> <span class="j-str">"540P"</span><span class="j-punct">,</span>
    <span class="j-key">"duration"</span><span class="j-punct">:</span>   <span class="j-num">5</span><span class="j-punct">,</span>
    <span class="j-key">"seed"</span><span class="j-punct">:</span>       <span class="j-num">42</span><span class="j-punct">,</span>
    <span class="j-key">"offload"</span><span class="j-punct">:</span>    <span class="j-bool">true</span><span class="j-punct">,</span>
    <span class="j-key">"low_vram"</span><span class="j-punct">:</span>   <span class="j-bool">false</span><span class="j-punct">,</span>
    <span class="j-key">"ref_imgs"</span><span class="j-punct">:</span>   <span class="j-punct">[</span><span class="j-str">"uploads/personagem.jpg"</span><span class="j-punct">]</span>   <span class="j-comment">‚Üê caminho fixo</span>
  <span class="j-punct">},</span>
  <span class="j-punct">{</span>
    <span class="j-key">"label"</span><span class="j-punct">:</span>       <span class="j-str">"Cena 2 ‚Äî Extens√£o"</span><span class="j-punct">,</span>
    <span class="j-key">"task_type"</span><span class="j-punct">:</span>   <span class="j-str">"single_shot_extension"</span><span class="j-punct">,</span>
    <span class="j-key">"resolution"</span><span class="j-punct">:</span>  <span class="j-str">"540P"</span><span class="j-punct">,</span>
    <span class="j-key">"duration"</span><span class="j-punct">:</span>    <span class="j-num">10</span><span class="j-punct">,</span>
    <span class="j-key">"seed"</span><span class="j-punct">:</span>        <span class="j-num">43</span><span class="j-punct">,</span>
    <span class="j-key">"offload"</span><span class="j-punct">:</span>     <span class="j-bool">false</span><span class="j-punct">,</span>
    <span class="j-key">"low_vram"</span><span class="j-punct">:</span>    <span class="j-bool">true</span><span class="j-punct">,</span>
    <span class="j-key">"input_video"</span><span class="j-punct">:</span> <span class="j-str">"{{ "{{prev}}" }}"</span>    <span class="j-comment">‚Üê output da Cena 1</span>
  <span class="j-punct">},</span>
  <span class="j-punct">{</span>
    <span class="j-key">"label"</span><span class="j-punct">:</span>       <span class="j-str">"Cena 3 ‚Äî Transi√ß√£o"</span><span class="j-punct">,</span>
    <span class="j-key">"task_type"</span><span class="j-punct">:</span>   <span class="j-str">"shot_switching_extension"</span><span class="j-punct">,</span>
    <span class="j-key">"resolution"</span><span class="j-punct">:</span>  <span class="j-str">"540P"</span><span class="j-punct">,</span>
    <span class="j-key">"duration"</span><span class="j-punct">:</span>    <span class="j-num">5</span><span class="j-punct">,</span>
    <span class="j-key">"seed"</span><span class="j-punct">:</span>        <span class="j-num">44</span><span class="j-punct">,</span>
    <span class="j-key">"offload"</span><span class="j-punct">:</span>     <span class="j-bool">false</span><span class="j-punct">,</span>
    <span class="j-key">"low_vram"</span><span class="j-punct">:</span>    <span class="j-bool">true</span><span class="j-punct">,</span>
    <span class="j-key">"input_video"</span><span class="j-punct">:</span> <span class="j-str">"{{ "{{prev}}" }}"</span>    <span class="j-comment">‚Üê output da Cena 2</span>
  <span class="j-punct">},</span>
  <span class="j-punct">{</span>
    <span class="j-key">"label"</span><span class="j-punct">:</span>       <span class="j-str">"Cena 4 ‚Äî Volta √† Cena 1"</span><span class="j-punct">,</span>
    <span class="j-key">"task_type"</span><span class="j-punct">:</span>   <span class="j-str">"single_shot_extension"</span><span class="j-punct">,</span>
    <span class="j-key">"resolution"</span><span class="j-punct">:</span>  <span class="j-str">"540P"</span><span class="j-punct">,</span>
    <span class="j-key">"duration"</span><span class="j-punct">:</span>    <span class="j-num">8</span><span class="j-punct">,</span>
    <span class="j-key">"seed"</span><span class="j-punct">:</span>        <span class="j-num">45</span><span class="j-punct">,</span>
    <span class="j-key">"offload"</span><span class="j-punct">:</span>     <span class="j-bool">false</span><span class="j-punct">,</span>
    <span class="j-key">"low_vram"</span><span class="j-punct">:</span>    <span class="j-bool">true</span><span class="j-punct">,</span>
    <span class="j-key">"input_video"</span><span class="j-punct">:</span> <span class="j-str">"{{ "{{job:0}}" }}"</span>   <span class="j-comment">‚Üê output da Cena 1 (√≠ndice 0)</span>
  <span class="j-punct">}</span>
<span class="j-punct">]</span></pre>
  </div>

  <div class="note warn">
    <strong>Importante:</strong> √≠ndices come√ßam em 0 e seguem a ordem da fila.
    <code>{{ "{{prev}}" }}</code> √© equivalente a <code>{{ "{{job:N-1}}" }}</code> onde N √© o √≠ndice da cena atual.
    A fila processa em sequ√™ncia ‚Äî a cena referenciada deve vir antes desta.
  </div>

  <!-- EXEMPLOS -->
  <h2 id="exemplos">Exemplos prontos para download</h2>
  <p>Clique em <strong>‚Üì Baixar</strong> para salvar o arquivo e import√°-lo na aba Fila.</p>

  <!-- Exemplo 1 -->
  <div class="example-card">
    <div class="example-card-header">
      <div class="example-icon">üé¨</div>
      <div class="example-info">
        <div class="example-title">Roteiro ‚Äî 5 cenas</div>
        <div class="example-desc">
          Uma hist√≥ria coerente: personagem acorda, olha pela janela, close cinem√°tico, sai para a rua, narra para c√¢mera.
          Demonstra o uso de todas as quatro tarefas em sequ√™ncia.
        </div>
      </div>
      <div class="example-actions">
        <button class="btn-copy" id="copy-btn-1" onclick="copyExample('exemplo_roteiro')">‚éò Copiar</button>
        <a class="btn-dl" href="/doc/download/exemplo_roteiro.json" download="exemplo_roteiro.json">‚Üì Baixar</a>
      </div>
    </div>
    <div class="example-scenes">
      <span class="scene-badge badge-r2v">Cena 1 ¬∑ reference_to_video</span>
      <span class="scene-badge badge-sse">Cena 2 ¬∑ single_shot_extension</span>
      <span class="scene-badge badge-sw">Cena 3 ¬∑ shot_switching [ZOOM_IN_CUT]</span>
      <span class="scene-badge badge-r2v">Cena 4 ¬∑ reference_to_video</span>
      <span class="scene-badge badge-av">Cena 5 ¬∑ talking_avatar</span>
    </div>
    <div class="code-wrap" style="border:none;border-radius:0;margin:0">
      <div class="code-header">
        <span class="lang">JSON</span>
        <span class="fname">exemplo_roteiro.json</span>
      </div>
      <pre id="code-exemplo_roteiro"></pre>
    </div>
  </div>

  <!-- Exemplo 2 -->
  <div class="example-card">
    <div class="example-card-header">
      <div class="example-icon">üèîÔ∏è</div>
      <div class="example-info">
        <div class="example-title">V√≠deo de 10 cenas ‚Äî Trilha de montanha</div>
        <div class="example-desc">
          Uma jornada √©pica: paisagem ao amanhecer, caminhante, acampamento, fogueira noturna, chegada ao cume e narra√ß√£o final.
          Uso avan√ßado com transi√ß√µes cinem√°ticas e varia√ß√£o de resolu√ß√£o.
        </div>
      </div>
      <div class="example-actions">
        <button class="btn-copy" id="copy-btn-2" onclick="copyExample('exemplo_10_cenas')">‚éò Copiar</button>
        <a class="btn-dl" href="/doc/download/exemplo_10_cenas.json" download="exemplo_10_cenas.json">‚Üì Baixar</a>
      </div>
    </div>
    <div class="example-scenes">
      <span class="scene-badge badge-r2v">01 ¬∑ reference_to_video</span>
      <span class="scene-badge badge-sse">02 ¬∑ single_shot_extension</span>
      <span class="scene-badge badge-r2v">03 ¬∑ reference_to_video</span>
      <span class="scene-badge badge-sw">04 ¬∑ shot_switching [ZOOM_IN_CUT]</span>
      <span class="scene-badge badge-r2v">05 ¬∑ reference_to_video</span>
      <span class="scene-badge badge-sse">06 ¬∑ single_shot_extension</span>
      <span class="scene-badge badge-sw">07 ¬∑ shot_switching [PAN_RIGHT_CUT]</span>
      <span class="scene-badge badge-r2v">08 ¬∑ reference_to_video</span>
      <span class="scene-badge badge-sse">09 ¬∑ single_shot_extension</span>
      <span class="scene-badge badge-av">10 ¬∑ talking_avatar</span>
    </div>
    <div class="code-wrap" style="border:none;border-radius:0;margin:0">
      <div class="code-header">
        <span class="lang">JSON</span>
        <span class="fname">exemplo_10_cenas.json</span>
      </div>
      <pre id="code-exemplo_10_cenas"></pre>
    </div>
  </div>

</div><!-- /content -->

<script>
// Load and display example JSON files
async function loadExamples() {
  for (const name of ['exemplo_roteiro', 'exemplo_10_cenas']) {
    try {
      const res = await fetch(`/doc/${name}.json`);
      const text = await res.text();
      document.getElementById(`code-${name}`).innerHTML = highlightJson(text);
    } catch(e) {
      document.getElementById(`code-${name}`).textContent = 'Erro ao carregar arquivo.';
    }
  }
}

async function copyExample(name) {
  try {
    const res = await fetch(`/doc/${name}.json`);
    const text = await res.text();
    await navigator.clipboard.writeText(text);
    const btn = document.getElementById(`copy-btn-${name === 'exemplo_roteiro' ? 1 : 2}`);
    btn.textContent = '‚úî Copiado';
    btn.classList.add('copied');
    setTimeout(() => { btn.textContent = '‚éò Copiar'; btn.classList.remove('copied'); }, 2000);
  } catch(e) { alert('N√£o foi poss√≠vel copiar.'); }
}

// Simple JSON syntax highlighter
function highlightJson(text) {
  return text
    .replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;')
    .replace(/"([^"]+)"(\s*:)/g,
      '<span class="j-key">"$1"</span><span class="j-punct">$2</span>')
    .replace(/:\s*"([^"]*)"/g,
      ': <span class="j-str">"$1"</span>')
    .replace(/:\s*(-?\d+\.?\d*)/g,
      ': <span class="j-num">$1</span>')
    .replace(/:\s*(true|false)/g,
      ': <span class="j-bool">$1</span>')
    .replace(/:\s*(null)/g,
      ': <span class="j-null">$1</span>')
    .replace(/([{}\[\],])/g,
      '<span class="j-punct">$1</span>');
}

loadExamples();
</script>
</body>
</html>
